from PyPDF2 import PdfReader, PdfWriter
from datetime import datetime

def add_micro_metadata(pdf_path, output_path, candidate_name="Professional Candidate"):
    reader = PdfReader(pdf_path)
    writer = PdfWriter()
    for page in reader.pages:
        writer.add_page(page)
    micro_keywords = """
    quality engineer inspection engineer quality assurance quality control mechanical engineering electrical engineering industrial engineering manufacturing engineering automotive engineering bachelor degree s1 sarjana reputable university universitas ternama minimum 2 years experience 3 years experience 4 years experience 5 years experience manufacturing industry automotive industry quality roles inspection roles quality inspector quality technician quality specialist quality analyst process quality product quality proficient data analysis tools excel microsoft excel advanced excel minitab statistical software spss python pandas numpy power bi tableau data visualization data analysis statistical analysis process improvement proactive identification effective solutions implementation fluent english spoken written excellent communication skills analytical skills problem solving capabilities decision making capabilities root cause analysis fishbone diagram 5 why analysis pdca cycle deming cycle continuous improvement kaizen lean manufacturing six sigma green belt black belt yellow belt iso 9001 iso 14001 iatf 16949 ts 16949 qms quality management system apqp advanced product quality planning ppap production part approval process fmea failure mode effects analysis control plan msa measurement system analysis spc statistical process control cpk process capability ppk process performance gr&r gage r&r calibration metrology inspection system management monitoring maintenance optimization downtime reduction efficiency enhancement oee overall equipment effectiveness mtbf mean time between failures mttr mean time to repair countermeasures development implementation collaboration cross functional teams internal departments equipment makers vendors suppliers quality issues prevention defect prevention poka yoke error proofing mistake proofing zero defects quality standards improvement inspection processes operational excellence excellence supervision guidance inspection technicians team leadership technical guidance training mentoring quality standards maintenance high quality standards first time yield fty defect rate reduction scrap reduction rework reduction cost of quality coq cost reduction waste elimination muda 7 wastes timwood takt time cycle time lead time reduction standard work standard operating procedure sop work instruction wi audit internal audit external audit customer audit supplier audit certification regulatory compliance safety standards ohsas 45001 environmental management smed single minute exchange of dies tpm total productive maintenance opex operational expenditure capex capital expenditure project management pmbok prince2 agile methodology risk management risk assessment fta fault tree analysis dmaic define measure analyze improve control dmadv define measure analyze design verify qfd quality function deployment voice of customer voc kano model supplier quality management sqm incoming quality control iqc outgoing quality control oqc in process quality control ipqc final inspection receiving inspection source inspection dimensional inspection visual inspection non destructive testing ndt destructive testing material testing hardness testing tensile testing compression testing fatigue testing corrosion testing metallurgy material science gd&t geometric dimensioning tolerancing cad computer aided design cam computer aided manufacturing solidworks autocad catia pro-e creo parametric finite element analysis fea computational fluid dynamics cfd plc programming scada hmi human machine interface robotics automation industry 4.0 iiot industrial internet of things digital transformation smart factory erp enterprise resource planning sap oracle mes manufacturing execution system crm customer relationship management plm product lifecycle management cmms computerized maintenance management system lims laboratory information management system barcode qr code rfid auto identification data capture industry automotive manufacturing automotive parts components assembly powertrain chassis body interior exterior electrical electronic systems mechatronics embedded systems iatf international automotive task force vda verband der automobilindustrie aiag automotive industry action group japanese manufacturers german manufacturers american manufacturers oem original equipment manufacturer tier 1 supplier tier 2 supplier tier 3 supplier jis just in sequence jit just in time kanban pull system push system supply chain management logistics warehouse management inventory management wip work in progress finished goods traceability serialization batch tracking recall management customer complaints 8d report corrective action preventive action car corrective action request par preventive action request ncr non conformance report concession deviation permit material review board mrb customer satisfaction customer quality interface cqi supplier development vendor development subcontractor management outsourcing insourcing near sourcing reshoring offshoring global supply chain local content import substitution export orientation trade compliance customs regulation duty drawback ft free trade agreement rcep regional comprehensive economic partnership apec asia pacific economic cooperation asean association of southeast asian nations eu european union nafta usmca united states mexico canada agreement mercosur southern common market saarc south asian association for regional cooperation au african union gcc gulf cooperation council oic organization of islamic cooperation un united nations who world health organization ilo international labor organization iso international organization for standardization iec international electrotechnical commission astm american society for testing materials asme american society of mechanical engineers sae society of automotive engineers ieee institute of electrical electronics engineers asq american society for quality jsa japanese standards association din deutsches institut für normung bsi british standards institution afnor association française de normalisation uni ente italiano di normazione une una norma española sn norwegian standards sfs finnish standards association sis standardiseringen i sverige ds danish standards pkn polski komitet normalizacyjny ms malaysian standards sni standar nasional indonesia thai industrial standards tis vietnam standards tcvn chinese standards gb japanese industrial standards jis korean standards ks indian standards is australian standards as nzs new zealand standards canadian standards association csa south african bureau of standards sabs brazilian association of technical standards abnt argentine institute for standardization iram mexican institute for standardization imenci russian federation standards gost r kazakhstan standards kz belarus standards stb ukraine standards dstu uzbekistan standards uzturboq turkey standards tse iran standards isiri saudi arabian standards saso egyptian organization for standardization eos algerian institute of standardization ianor moroccan institute of standardization imanet tunisian institute of standardization inorpi kenya bureau of standards kebs nigerian standards organization son ghana standards authority gsa south african national standards sans botswana bureau of standards boys namibian standards institution nsi zambia bureau of standards zabs zimbabwe standards association saz eac east african community comesa common market for eastern southern africa ecowas economic community of west african states sadc southern african development community igad intergovernmental authority on development amu arab maghreb union opec organization of petroleum exporting countries oecd organisation for economic co-operation development world bank imf international monetary fund wto world trade organization unido united nations industrial development organization unctad united nations conference on trade development itc international trade center wipo world intellectual property organization upov international union for the protection of new varieties of plants icsid international centre for settlement of investment disputes miga multilateral investment guarantee agency ifc international finance corporation adb asian development bank afdb african development bank idb inter american development bank ebrd european bank for reconstruction development eib european investment bank aiib asian infrastructure investment bank ndb new development bank bis bank for international settlements bis bank of international settlements imo international maritime organization icao international civil aviation organization itu international telecommunication union who world health organization fao food agriculture organization of the united nations unesco united nations educational scientific cultural organization unicef united nations children's fund undp united nations development programme unfpa united nations population fund unhcr united nations high commissioner for refugees unodc united nations office on drugs crime un environment united nations environment programme un habitat united nations human settlements programme un women united nations entity for gender equality empowerment of women ilo international labour organization wmo world meteorological organization igo international governmental organization ingo international non governmental organization csr corporate social responsibility esg environmental social governance sustainability renewable energy carbon footprint reduction greenhouse gas emissions ghg climate change global warming paris agreement kyoto protocol montreal protocol basel convention rotterdam convention stockholm convention minamata convention biodiversity conservation circular economy green manufacturing eco design life cycle assessment lca carbon credit carbon trading esg reporting integrated reporting triple bottom line people planet profit social responsibility ethical business practices corporate governance anti corruption transparency accountability fair trade ethical sourcing conflict minerals due diligence human rights labor rights workplace safety occupational health safety ohs emergency response crisis management business continuity planning bcp disaster recovery drp insurance risk transfer captive insurance mutual insurance co insurance reinsurance surety bond performance bond advance payment bond retention money bond tender bond bid bond customs bond freight insurance cargo insurance marine insurance aviation insurance property insurance equipment insurance liability insurance professional indemnity insurance product liability insurance public liability insurance employers liability insurance workers compensation insurance health insurance life insurance personal accident insurance travel insurance cyber insurance data breach insurance intellectual property insurance patent insurance trademark insurance copyright insurance design insurance utility model insurance trade secret protection know how protection technology transfer licensing franchising joint venture strategic alliance merger acquisition m&a divestiture spin off carve out management buyout mbo leveraged buyout lbo venture capital private equity angel investor crowdfunding ipo initial public offering secondary offering rights issue bonus issue stock split reverse stock split dividend share buyback treasury shares employee stock option plan esop performance share plan psp restricted stock unit rsu phantom stock stock appreciation right sar deferred compensation executive compensation board of directors board committee audit committee risk committee remuneration committee nomination committee corporate governance committee sustainability committee ethics compliance committee shareholder meeting annual general meeting agm extraordinary general meeting egm proxy voting cumulative voting straight voting preferred stock common stock class a shares class b shares dual class shares golden share poison pill staggered board classified board white knight white squire pac man defense crown jewel defense greenmail fair price provision supermajority provision anti takeover provisions takeover bid hostile takeover friendly takeover reverse takeover backdoor listing special purpose acquisition company spac blank check company
    """
    
    cleaned_keywords = ' '.join(micro_keywords.split())
    current_date = datetime.now().strftime('D:%Y%m%d%H%M%S')
    
    metadata = {
        '/Title': f'Performance Metrics - {candidate_name}',
        '/Author': candidate_name,
        '/Subject': cleaned_keywords[:2000],
        '/Keywords': cleaned_keywords[:500],
        '/CreationDate': current_date + 'Z',
        '/ModDate': current_date + 'Z',
        '/Custom': cleaned_keywords[:1000]
    }
    
    writer.add_metadata(metadata)
    with open(output_path, 'wb') as output_file:
        writer.write(output_file)
    

if __name__ == "__main__":
    input_pdf = "ILYASCV.pdf"
    output_pdf = "cv.pdf"
    
    try:
        add_micro_metadata(input_pdf, output_pdf, "Nama Kandidat Anda")
        print("dioptimalkan untuk sistem screening AI")
        print("Metadata telah disisipkan")
    except Exception as e:
        print("Error: {e}")
